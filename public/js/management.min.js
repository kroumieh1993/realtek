!function(a){"use strict";function b(b,c){var d={action:"es_get_locations",nonce:Estatik.nonce.nonce_locations,types:b.data("address-components")},e=b.data("placeholder");e?b.html("<option>"+e+"</option>"):b.html(""),void 0!==c&&(d.dependency_id=c.val()),a.get(Estatik.settings.ajaxurl,d,function(a){a&&(Object.keys(a).map(function(c,d){var e=a[c];b.data("value")&&b.data("value")==c?b.append("<option value='"+c+"' selected>"+e+"</option>"):b.append("<option value='"+c+"'>"+e+"</option>")}),b.data("value")&&b.trigger("change"))},"json")}a(function(){a(".es-property-form .js-es-tabs").on("tab_changed",function(){var b=a(this).find(".js-es-tabs__nav .active");b.prev().length?a(this).find('.js-es-nav-link[data-type="prev"]').css("visibility","visible"):a(this).find('.js-es-nav-link[data-type="prev"]').css("visibility","hidden"),b.next().length?(a(this).find('.js-es-nav-link[data-type="next"]').removeClass("es-hidden"),a(this).find(".js-es-save-listing-secondary").addClass("es-hidden"),a(this).find(".js-es-save-listing").css("visibility","visible")):(a(this).find('.js-es-nav-link[data-type="next"]').addClass("es-hidden"),a(this).find(".js-es-save-listing-secondary").removeClass("es-hidden"),a(this).find(".js-es-save-listing").css("visibility","hidden"))}).trigger("tab_changed"),a(".js-es-nav-link").click(function(b){var c=a(this).data("type"),d=a(this).closest(".js-es-tabs").find(".js-es-tabs__nav .active");return"prev"===c?d.prev().length&&(d.prev().find("a").trigger("click"),a([document.documentElement,document.body]).animate({scrollTop:a(d.prev().find("a").data("tab")).offset().top-100},500)):d.next().length&&(d.next().find("a").trigger("click"),a([document.documentElement,document.body]).animate({scrollTop:a(d.next().find("a").data("tab")).offset().top-120},500)),b.preventDefault(),!1}),a(".js-es-agency").each(function(){a(this).select2({width:"style",placeholder:a(".js-es-agency").data("placeholder")})}),a(document).on("click",".js-es-delete-property",function(){var b=a(this),c=b.data("entity-id"),d={action:"es_management_delete_property_popup",_nonce:Estatik.nonce.delete_property_popup,property_id:c};return c&&a.get(Estatik.settings.ajaxurl,d,function(b){a.magnificPopup.open({items:{src:b.message},type:"inline",midClick:!0,mainClass:"es-magnific",closeMarkup:'<span class="es-icon es-icon_close mfp-close"></span>',callbacks:{beforeOpen:function(){a.magnificPopup.close()}}}),setTimeout(function(){EstatikProperties.initCarousel(a(document).find(".es-magnific-popup--delete-action"))})},"json"),!1}),a(document).on("click",".js-es-delete-selected-listings",function(){var b=a(".js-es-table tbody .es-column--_manage-checkbox input[type=checkbox]:checked"),c=[],d=a(this).data("action");if(b.each(function(){c.push(a(this).val())}),c.length){var e=new URL(window.location.href);e.searchParams.append("action",d),e.searchParams.append("post_ids",c),e.searchParams.append("_nonce",a(this).data("nonce")),window.location.href=e.href}}),a(document).on("click",".js-es-delete-bulk, .js-es-duplicate-bulk",function(){var b=EstatikManagement.tr,c=a(this).data("action"),d=a(".js-es-table tbody .es-column--_manage-checkbox input[type=checkbox]:checked");if(1===d.length&&"delete"===c)a('.js-es-delete-property[data-entity-id="'+d.val()+'"]').trigger("click");else{var e="<div class='es-magnific-popup es-magnific-popup--delete-homes'><h4>"+b[c+"_homes"].replace("%s",d.length)+"</h4><div class='es-magnific-buttons'><a href='#' class='es-btn es-btn--default js-es-close-popup'>"+b.cancel+"</a><a href='#' data-nonce='"+a(this).data("nonce")+"' data-action='"+a(this).data("action")+"' class='es-btn es-btn--secondary js-es-close-popup js-es-delete-selected-listings'><span class='es-icon es-icon_trash'></span>"+b[c+"_homes_btn"]+"</a></div>";a.magnificPopup.open({closeMarkup:'<span class="es-icon es-icon_close mfp-close"></span>',mainClass:"es-magnific",items:{src:e},type:"inline"})}return!1})}),window.esLoadFieldLocations=b}(jQuery);