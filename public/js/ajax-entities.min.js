!function(a){"use strict";function b(a){switch(a){case"listings":return h;case"agent":return f;case"agency":return g}}function c(b,c){"listings"===c&&(a(Realtek.settings.hfm_toggle_sidebar_selector).toggleClass("es-hidden","half_map"===b),a(document).trigger("listings_toggle_sidebar",{layout:b,entity_type:c}))}var d={initSearch:function(){a(document).find("[data-search-form-selector]").each(function(){var c,d=a(a(this).data("search-form-selector")).not(".js-es-event-added"),f=a(this);d.length&&d.each(function(){a(this).addClass("js-es-search--ajax").addClass("js-es-event-added");var d=a(this).find("form");d.on("change","input:not([type=text]):not([type=number]):not([type=search]),select",function(){var b=a(this),c=new e(f.find(".js-es-entities").data("hash"));"checkbox"===b.attr("type")&&c.delete(b.attr("name")),d.submit()}),d.on("focusout","input[type=text], input[type=number]",function(){d.submit()}),d.on("submit",function(){var g=f.find(".js-es-entities__wrap_inner"),h=d.serializeArray(),i=g.closest(".js-es-entities-wrap").find(".js-es-entities"),j=new e(i.data("hash"));if(j.clearQueryArguments(),h.length){var k={};h.forEach(function(a){a.value?(-1!==a.name.indexOf("[]")&&(k[a.name]=k[a.name]?k[a.name]:0,a.name=a.name.replace("[]","["+k[a.name]+++"]")),j.setValue(a.name,a.value)):j.delete(a.name)}),j.delete("prop_id"),j.setValue("page_num",1),j.setValue("paged-"+j.getValue("loop_uid"),1),j.setHistoryQuery()}i.data("hash",j.getHash()),c&&c.abort(),g.find(".js-es-entities").addClass("es-entities--loading");var l=i.data("entity"),m=b(l);return c=a.post(Realtek.settings.ajaxurl,{action:"get_"+l,hash:j.getHash(),reload_map:1},function(a){a=a||{},"success"===a.status&&m.append(a,g)},"json"),!1})})})},append:function(c,d,e){if("success"===c.status){var f=d.replaceWith(c.message),g=f.find(".js-es-entities"),h=g.data("entity");if(h){b(h).init(f.closest(".js-es-entities-wrap"))}if((e="undefined"===e||e)&&d.length){var i=d.offset().top-+Realtek.settings.listings_offset_corrector;a([document.documentElement,document.body]).animate({scrollTop:i||0},500)}return d.find(".js-es-entities").removeClass("es-entities--loading"),a(window).trigger("resize"),f}}},e=function(a,b){b=b||!1;var c=this;return this.hash=a,this.attributes=new URLSearchParams(decodeURIComponent(escape(window.atob(this.hash)))),b||(this.tempEntitiesHash=new e(a,!0)),this.shortcode_attributes=["layout","posts_per_page","disable_navbar","show_sort","show_total","show_categories","show_page_title","show_layouts","limit","page_num","loop_uid","page_title","fields","collapsed_fields","main_fields","ignore_search","search_form_selector","enable_search","search_type","view_all_link_name","wishlist_confirm","view_all_page_id","disable_pagination","_ajax_mode","_ignore_coordinates","reload_map","hfm_full_width","ajax_response_mode","fields_delimiter","action","hash","prop_id","enable_ajax","setup_postdata_post_id","strict_address","map_show"],e.prototype.clearQueryArguments=function(){var a=this,b=this.tempEntitiesHash,c=Realtek.search.fields;this.tempEntitiesHash.getAttributes().forEach(function(d,e){b.shortcode_attributes.includes(e)||c.includes(e)||a.delete(e)})},e.prototype.getValue=function(a){return c.attributes.get(a)},e.prototype.getAllValues=function(a){return c.attributes.getAll(a)},e.prototype.setValue=function(a,b){return c.attributes.set(a,b),c.hash=btoa(c.attributes.toString()),c},e.prototype.delete=function(a){return c.attributes.delete(a),c.hash=btoa(c.attributes.toString()),c},e.prototype.getHash=function(){return c.hash},e.prototype.getAttributes=function(){return this.attributes},e.prototype.toString=function(){return this.getHash()},e.prototype.setHistoryQuery=function(){var a=this.getAttributes(),b=this.tempEntitiesHash;b.getAttributes().forEach(function(c,d){b.shortcode_attributes.forEach(function(b,c){d.includes(b)&&a.delete(d)})});var c=decodeURIComponent(window.location.pathname+"?"+a.toString());window.history.replaceState({},"",c)},this};window.RealtekEntitiesHash=e;var f={init:function(){RealtekResponsinator.init("agents")},getLayoutEntityType:function(){return"entities"},getLayoutClass:function(a){return["","--md","--lg","--sm","--xs"].forEach(function(b){if(a.hasClass("es-entities"+b))return"es-entities"+b}),a.hasClass("es-entities--grid")?"es-entities--grid":"es-entities--list"},append:function(a,b,c){"success"===a.status&&d.append(a,b,c)}},g=f,h={halfMapInstances:[],init:function(){setTimeout(function(){h.initCarousel()},10)},getLayoutEntityType:function(){return"listings"},append:function(a,b,c){if("success"===a.status&&(d.append(a,b,c),+a.reload_map&&a.loop_uid)){var e=h.halfMapInstances[a.loop_uid];e&&(a.coordinates?e.setMarkers(a.coordinates):e.deleteMarkers())}},getLayoutClass:function(a){for(var b=1;b<10;b++){if(a.hasClass("es-listings--grid-"+b))return"es-listings--grid-"+b;if(a.hasClass("es-listings--grid-"+b))return"es-listings--grid-"+b}return"es-listings--list"},initCarousel:function(b,c){c=c||a(document),a(".js-es-slick.slick-initialized",c).slick("unslick"),a(".js-es-slick",c).each(function(){var c=a(this).data("slick")||{},d=c.slidesToShow||1,e=c.vertical||!1,f=!1;if(void 0!==c.infinite&&(c.infinite=Boolean(c.infinite)),c.rtl=Realtek.settings.is_rtl,e)a(this).hasClass("slick-initialized")||(f=a(this));else if(!a(this).hasClass("slick-initialized")){var g=a(this).width(),i=parseInt(g/230)||1;f=a(this),c.slidesToShow=d<=i?d:i}f&&(f.on("init",function(){f.removeClass("slick-hidden")}).slick(c),f.find(".js-es-slick").length&&f.on("beforeChange",function(c,d,e,g){a(d.$list).find(".js-es-slick:not(.slick-initialized)").length&&h.initCarousel(b,f)}))})}};window.RealtekProperties=h;var i=function(b){this.$wrapper=b,this.mapInstance=null,this.markers=[],this.clusters=[],this.load_first_time=!0,this.ignoreLoadListingsByBounds=!0;var c=this;i.prototype.init=function(){if(this.setFullWidth(),"undefined"==typeof google)return!1;this.$map=a(".js-es-map",c.$wrapper),this.map=c.$map[0];var b={draggable:!0,zoom:16};Realtek.settings.map_zoom&&(b.zoom=+Realtek.settings.map_zoom);var d=+Realtek.settings.is_cluster_enabled,e=Realtek.settings.map_marker_type,f=!d||"price"===e;!Realtek.settings.can_zoom&&f&&(Realtek.settings.map_zoom_min&&(b.minZoom=+Realtek.settings.map_zoom_min),Realtek.settings.map_zoom_max&&(b.maxZoom=+Realtek.settings.map_zoom_max)),this.mapInstance=new google.maps.Map(c.map,b),this.setMarkers(c.$map.data("listings")),this.mapInstance.addListener("click",function(){c.close_popups(),a(".es-price-marker--active").removeClass("es-price-marker--active")}),a(window).on("resize",function(){c.setFullWidth()}),c.mapInstance.addListener("zoom_changed",function(){if(c.load_first_time||c.ignoreZoomHandler)return c.load_first_time=!1,!1;c.close_popups(),a(".es-price-marker--active").removeClass("es-price-marker--active"),c.loadListingsFromVisibleBounds()}),c.mapInstance.addListener("dragend",function(){c.loadListingsFromVisibleBounds()})},i.prototype.setFullWidth=function(){if(this.$wrapper.hasClass("es-properties--hfm")&&this.$wrapper.hasClass("es-properties--hfm--full-width")){this.$wrapper.css("margin-left",0);var a=this.$wrapper[0].getBoundingClientRect(),b=a.left;this.$wrapper.css("margin-left",-b+"px")}},i.prototype.loadListingsFromVisibleBounds=function(){if(c.ignoreLoadListingsByBounds)return!1;if("undefined"==typeof google)return!1;var b=[],d=c.mapInstance.getBounds();if(c.markers.length){for(var f in c.markers)if(c.markers.hasOwnProperty(f)){var g=c.markers[f].getPosition();void 0!==d&&d.contains(g)&&b.push(c.markers[f].post_id)}b.length||b.push(-1);var i=new e(c.$wrapper.find(".js-es-listings").data("hash"));i.setValue("prop_id",b.join(",")),i.setValue("page_num",1),i.setValue("paged-"+i.getValue("loop_uid"),1),void 0!==c.xhr&&c.xhr.abort(),c.$wrapper.find(".js-es-listings").addClass("es-listings--loading"),c.xhr=a.post(Realtek.settings.ajaxurl,{reload_map:0,hash:i.getHash(),action:"get_listings"},function(a){h.append(a,c.$wrapper.find(".js-es-entities__wrap_inner"),!1)},"json")}},a(c.$wrapper).on("mouseenter",".js-es-listing",function(){var b=a(this).data("post-id");if(a(".es-price-marker--active").removeClass("es-price-marker--active"),a(".es-price-marker--"+b).addClass("es-price-marker--active"),void 0!==c.markers[b]){var d=c.markers[b],e={};"price"!==Realtek.settings.map_marker_type&&(e=d.getIcon());var f=d.marker_svg;f&&(f=f.replaceAll("data-color",'style="fill: '+Realtek.settings.main_color+'"'),e.url="data:image/svg+xml;charset=UTF-8;base64,"+window.btoa(f),d.setIcon(e))}}),a(c.$wrapper).on("mouseleave",".js-es-listing",function(){var b=a(this).data("post-id");if(void 0!==c.markers[b]){var d=c.markers[b],e={};"price"!==Realtek.settings.map_marker_type&&(e=d.getIcon());var f=d.marker_svg;f&&(f=f.replaceAll("data-color",'style="fill: '+d.marker_color+'"'),e.url="data:image/svg+xml;charset=UTF-8;base64,"+window.btoa(f),d.setIcon(e))}}),i.prototype.deleteMarkers=function(){if("undefined"==typeof google)return!1;if(c.clusters.length)for(var a in c.clusters)c.clusters.hasOwnProperty(a)&&c.clusters[a].clearMarkers();if(c.markers.length)for(var b in c.markers)c.markers.hasOwnProperty(b)&&c.markers[b].setMap(null);c.markers=null,c.markers=[]},i.prototype.setMarkers=function(b){if("undefined"==typeof google)return!1;c.ignoreLoadListingsByBounds=!0;var d,e=new google.maps.LatLngBounds,f=new OverlappingMarkerSpiderfier(c.mapInstance,{markersWontMove:!0,markersWontHide:!0,basicFormatEvents:!0,keepSpiderfied:!0});if(c.$map.data("listings",b),c.deleteMarkers(),b){for(var g in b)if(b.hasOwnProperty(g)){var h=new google.maps.LatLng(parseFloat(b[g].lat),parseFloat(b[g].lng));if(e.extend(h),b[g].position=h,"price"===Realtek.settings.map_marker_type){if(b[g].price){var j=new EsGoogleMapPriceMarker(b[g],c.propertyPopup(h,b[g]));j.setMap(c.mapInstance),j.getMap().panToWithOffset(h,0,120),j.post_id=b[g].post_id,c.markers[b[g].post_id]=j}}else{d={position:h,map:c.mapInstance,optimized:!1,zIndex:99};var k=null,l=null;void 0!==b[g].marker?(k=Realtek.settings.map_marker_icons[b[g].marker],l=b[g].marker_color):(k=Realtek.settings.map_marker_icons[Realtek.settings.map_marker_icon],l=Realtek.settings.map_marker_color),d.marker_svg=k,d.marker_color=l;var m=a(k),n=m.attr("width"),o=+m.attr("height");k=k.replaceAll("data-color",'style="fill: '+l+'"'),d.icon={url:"data:image/svg+xml;charset=UTF-8;base64,"+window.btoa(k),scaledSize:new google.maps.Size(n,o),size:new google.maps.Size(n,o),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(n/2,o/2),optimized:!1},d=new google.maps.Marker(d),d.post_id=b[g].post_id,google.maps.event.addListener(d,"click",c.propertyPopup(h,b[g])),c.markers[b[g].post_id]=d,f.addMarker(d)}}if(void 0!==Realtek.settings.default_lat_lng){var p=Realtek.settings.default_lat_lng;c.mapInstance.setCenter({lat:+p[0],lng:+p[1]}),Realtek.settings.map_zoom&&c.mapInstance.setZoom(+Realtek.settings.map_zoom)}else void 0!==e&&(1===Object.keys(b).length?Object.keys(b).forEach(function(a){c.mapInstance.setCenter({lat:+b[a].lat,lng:+b[a].lng}),c.mapInstance.setZoom(+Realtek.settings.map_zoom)}):(c.mapInstance.fitBounds(e),c.mapInstance.panToBounds(e)));if(c.markers&&Realtek.settings.is_cluster_enabled&&"price"!==Realtek.settings.map_marker_type){var q=[{width:44,height:44,url:i.getClusterIcon(),textColor:"white",textSize:10,anchorText:[16],anchorIcon:[38,22]}];"cluster3"===Realtek.settings.map_cluster_icon&&(q[0].textColor=Realtek.settings.map_cluster_color),+Realtek.settings.is_cluster_enabled&&"price"!==Realtek.settings.map_marker_type&&c.clusters.push(new MarkerClusterer(c.mapInstance,c.markers,{maxZoom:12,styles:q}))}}c.ignoreLoadListingsByBounds=!1},i.prototype.propertyPopup=function(b,d){return function(){var b={post_id:d.post_id,action:"es_get_property_item"};void 0!==c.xhr&&c.xhr.abort(),c.close_popups(),c.xhr=a.post(Realtek.settings.ajaxurl,b,function(b){if(b=b||{},d.content=b.content,d.position=new google.maps.LatLng(d.lat,d.lng),"success"===b.status){var e=new EsGoogleMapPopup(d);c.mapInstance.setCenter(d.position),e.setMap(c.mapInstance),e.getMap().panToWithOffset(d.position,0,120),setTimeout(function(){h.initCarousel(a(c.mapInstance.getDiv()))},100)}},"json")}},i.prototype.close_popups=function(){var a=c.mapInstance.getDiv().querySelector(".es-map-popup");a&&a.remove()},i.getClusterIcon=function(a){a=a||Realtek.settings.map_cluster_color;var b=Realtek.settings.map_cluster_icons[Realtek.settings.map_cluster_icon];return b=b.replaceAll("data-color",'style="fill:'+a+'"').replaceAll("data-hide",'style="fill:#ffffff"'),"data:image/svg+xml;base64,"+window.btoa(b)}};window.RealtekHalfMap=i,a(function(){h.init(),d.initSearch(),a(".js-es-properties__map.es-properties__map--visible").each(function(){var b=a(this).closest(".js-es-properties"),d=new i(b),f=b.find(".js-es-listings"),g=new e(f.data("hash"));h.halfMapInstances[g.getValue("loop_uid")]=d,d&&(d.init(),c("half_map","listings"))}),a(document).on("click",".js-es-entities-filter-item",function(c){var d=a(this),f=d.data("query");if(f&&Object.keys(f).length){var g=d.closest(".js-es-entities-wrap").find(".js-es-entities"),h=d.closest(".js-es-entities-wrap").find(".js-es-entities__wrap_inner"),i=g.data("entity"),j=b(i),k=new e(g.data("hash"));Object.entries(f).forEach(function(a){k.setValue(a[0],a[1])}),k.setHistoryQuery();var l={action:"get_"+i,hash:k.getHash(),reload_map:1};a.post(Realtek.settings.ajaxurl,l,function(a){j.append(a,h)},"json")}return c.preventDefault(),!1}),a(document).on("click",".js-es-change-layout",function(){if(!a(this).hasClass("es-btn--active")){var d=a(this).data("layout"),f=a(this).closest(".js-es-control--layouts"),g=a(this).closest(".js-es-entities-wrap"),j=g.find(".js-es-entities"),k=j.data("entity"),l=b(k),m=l.getLayoutClass(j);g.removeClass("es-properties--hfm");var n=new e(j.data("hash"));n.setValue("layout",d),n.setHistoryQuery(),f.find(".js-es-change-layout").removeClass("es-btn--active"),a(this).addClass("es-btn--active");var o=d;if("half_map"===d){g.find(".js-es-properties__map").addClass("es-properties__map--visible"),g.addClass("es-properties--hfm");var p=new i(g);h.halfMapInstances[n.getValue("loop_uid")]=p,p&&p.init(),d=Realtek.settings.grid_layout}else{var q=g.find(".js-es-properties__map");q.length&&(q.removeClass("es-properties__map--visible"),g.css({"margin-left":"-15px"}))}Realtek.settings.hfm_toggle_sidebar&&Realtek.settings.hfm_toggle_sidebar_selector&&c(o,k);var r=l.getLayoutEntityType();j.removeClass(m).addClass("es-"+r+"--"+d).data("layout","es-"+r+"--"+d),j.data("hash",n.getHash()),l.init(),a(window).trigger("resize")}return!1}),a(document).on("click",".js-es-pagination a.page-numbers",function(){var c=a(this).closest(".es-pagination");if(!c.find(".page-numbers--preload").length){var d=c.closest(".es-properties--hfm").length,f=a(this).data("page-number"),g=a(this).closest(".js-es-entities__wrap_inner"),h=g.find(".js-es-entities");h.addClass("es-entities--loading");var i=new e(h.data("hash")),j=h.data("entity"),k=b(j),l={reload_map:d,action:"get_"+j,hash:i.setValue("page_num",f).getHash()},m=i.getValue("loop_uid"),n=g.find(".js-es-sort").val();i.setValue("paged-"+m,f),i.setValue("sort-"+m,n),i.setValue("sort",n),i.setHistoryQuery(),a(this).addClass("page-numbers--preload"),c.addClass("es-pagination--disabled"),a.post(Realtek.settings.ajaxurl,l,function(a){k.append(a,g,!0)},"json")}return!1}),a(document).on("change",".js-es-sort",function(){var c=a(this),d=c.closest(".js-es-entities__wrap_inner");if(d.length&&(c.prop("disabled","disabled"),d.length)){c.prop("disabled","disabled");var f=d.find(".js-es-entities");f.addClass("es-entities--loading");var g=new e(f.data("hash")),h=g.getValue("loop_uid");g.setValue("sort",c.val()),g.setValue("sort-"+h,c.val()),g.setValue("page_num",1),g.setValue("paged-"+h,1),g.setHistoryQuery();var i=f.data("entity"),j=b(i),k={action:"get_"+i,hash:g.getHash(),reload_map:1};a.post(Realtek.settings.ajaxurl,k,function(a){j.append(a,d)},"json").always(function(){c.removeProp("disabled").removeAttr("disabled")})}}),a(document).on("click",".js-es-remove-filters",function(){a(this).addClass("es-btn--preload").attr("disabled","disabled").prop("disabled","disabled");var b=a(this).closest(".js-es-entities-wrap");return b.find(".js-es-address").val(""),b.find(".js-es-search-nav__item").find("input,select").each(function(){var b=a(this),c=a(this).prop("type");if("radio"===c||"checkbox"===c){b.removeProp("checked").removeAttr("checked");var d=a(this).closest(".js-search-field-container").find('input[value=""]');d.length&&d.prop("checked","checked")}else a(this).val("")}),b.find(".js-es-search form").trigger("submit"),!1}),a(document).on("click",".js-es-listings-categories-ajax:not(.es-disable)",function(){var c=a(this),d=c.data("term");c.closest(".js-es-properties__categories").find(".es-active").removeClass("es-active"),c.addClass("es-disable").addClass("es-active");var f=a(this).closest(".js-es-entities__wrap_inner"),g=f.find(".js-es-entities");g.addClass("es-entities--loading");var h=new e(g.data("hash")),i=g.data("entity"),j=b(i);h.setValue("page_num",1),d?h.setValue("es_category",[d]):h.delete("es_category");var k={reload_map:0,action:"get_"+i,hash:h.getHash()};return h.setValue("paged-"+h.getValue("loop_uid"),1),h.setHistoryQuery(),a.post(Realtek.settings.ajaxurl,k,function(a){j.append(a,f)},"json").fail(function(){c.removeClass("es-disable").removeClass("es-active")}),!1})})}(jQuery);